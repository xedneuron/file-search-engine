<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Local Neural Search</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <style>
        .highlight { background-color: #fef08a; } /* Yellow highlight */
        .viewer-area { max-height: 80vh; overflow-y: auto; }
        pre { white-space: pre-wrap; word-wrap: break-word; }
        
        /* Spinning search animation */
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #e5e7eb;
            border-top: 4px solid #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        #loading-spinner {
            display: none;
            text-align: center;
            padding: 1.5rem;
            color: #6b7280;
        }
        
        #rag-loading-spinner {
            display: none;
            text-align: center;
            padding: 1.5rem;
            color: #6b7280;
        }
        
        #loading-spinner.active, #rag-loading-spinner.active {
            display: block;
        }
    </style>
</head>
<body class="bg-gray-100 h-screen overflow-hidden">

    <div class="flex h-full">
        <div class="w-1/3 flex flex-col border-r border-gray-300 bg-white shadow-lg z-10">
            <!-- Mode Toggle -->
            <div class="p-4 border-b border-gray-300 bg-gradient-to-r from-gray-50 to-gray-100">
                <div class="flex gap-2 mb-4">
                    <button class="flex-1 px-4 py-2 bg-blue-500 text-white rounded font-semibold hover:bg-blue-600 transition"
                            hx-get="/mode/data-search"
                            hx-target="#search-container"
                            hx-swap="innerHTML">
                        Search Engine
                    </button>
                    <button class="flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded font-semibold hover:bg-gray-400 transition"
                            hx-get="/mode/rag"
                            hx-target="#search-container"
                            hx-swap="innerHTML">
                        RAG
                    </button>
                </div>
            </div>

            <!-- Dynamic Content Container -->
            <div id="search-container">
                {% include '_data_search.html' %}
            </div>
        </div>

        <div id="file-viewer"
             class="flex-1 p-8 overflow-y-auto"
             hx-on:htmx:afterSwap="setTimeout(()=>{ const target = this.querySelector('.scroll-target'); if (target) { target.scrollIntoView({ behavior: 'smooth', block: 'center' }); } }, 40);">

            <div class="text-gray-400 text-center mt-20 text-xl">
                Select a file result to view contents.
            </div>
        </div>
    </div>

</body>
</html>
